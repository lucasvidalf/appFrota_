<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Ordem de Serviço</title>
  <style>
    :root{
      --bg:#a3e0db;--brand-dark:#0b4c59;--brand-mid:#3db7ac;--white:#fff;--text:#0b1f1e;
      --radius-lg:16px;--radius-md:12px;--radius-sm:8px;--shadow:0 8px 24px rgba(0,0,0,.08);
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Ubuntu,"Helvetica Neue",Arial,sans-serif;color:var(--text);background:var(--bg);-webkit-text-size-adjust:100%}
    .app{max-width:680px;margin:16px auto;padding:16px}
    .card-header{background:var(--brand-dark);color:var(--white);padding:20px 16px;border-radius:var(--radius-lg);box-shadow:var(--shadow);text-align:center}
    .title{margin:0 0 4px;font-size:clamp(22px,5vw,36px);letter-spacing:.5px}
    .subtitle{margin:0;opacity:.9;font-weight:600;font-size:clamp(14px,3.4vw,18px)}
    .section-title{margin:20px 0 8px;background:#3db7ac;color:#0b1f1e;font-weight:800;letter-spacing:.5px;padding:10px 14px;border-radius:var(--radius-md)}
    .card{background:var(--white);border-radius:var(--radius-lg);box-shadow:var(--shadow);padding:16px}
    .field{margin-bottom:14px}.label{display:block;font-weight:700;margin-bottom:8px}
    .control,.control2{display:block;width:100%;min-height:44px;font-size:16px;padding:10px 12px;border:1px solid #cfd8dc;border-radius:var(--radius-sm);background:#f9fafa;outline:none}
    .control2{padding:40px 12px}
    .control:focus,.control2:focus{border-color:var(--brand-mid);box-shadow:0 0 0 3px rgba(61,183,172,.25);background:#fff}
    input[type="datetime-local"].control{-webkit-appearance:none;appearance:none;max-width:100%;margin:0;padding-right:12px}
    .radio-group{display:grid;grid-template-columns:repeat(3,minmax(1,1fr));gap:10px;align-items:center}
    .radio-chip{display:flex;align-items:center;gap:8px;padding:10px 12px;border:1px solid #cfd8dc;border-radius:var(--radius-sm);background:#f9fafa;min-height:44px;font-size:16px}
    .radio-chip input{width:18px;height:18px}
    .actions{margin-top:8px}
    .btn{width:100%;border:0;border-radius:12px;padding:28px 16px;font-weight:800;font-size:24px;color:#fff;background:var(--brand-dark);box-shadow:0 6px 14px rgba(1,61,53,.2);cursor:pointer}
    .btn:hover{filter:brightness(1.06)} .btn:active{transform:translateY(1px)}

    .tile{
  	background-color:#3db7ac;
    }
    
    /* ====== CHECKBOX CHIPS (mesmo estilo dos radios) ====== */
    .check-group{
      display:grid;
      grid-template-columns:1fr 1fr;;
      gap:12px 14px;      
      align-items:start;
    }
    .check-chip{
      display:flex; align-items:center; gap:8px;
      padding:10px 12px;
      border:1px solid #cfd8dc;
      border-radius: var(--radius-sm);
      background:#f9fafa;
      min-height:44px; font-size:16px;
      cursor:pointer;
      user-select:none;
    }
    .check-chip input{ width:18px; height:18px; }
    .check-chip input:checked + span{
      font-weight:800; color:#0b4c59;
    }
    /* realce opcional quando marcado (suportado na maioria dos mobiles atuais) */
    .check-chip:has(input:checked){
      border-color: var(--brand-mid);
      background:#fff;
      box-shadow:0 0 0 3px rgba(61,183,172,.22);
    }
    /* responsivo como os radios */
    @media (max-width:520px){
      .check-group{ grid-template-columns:1fr }
    }
  
    a.tile{
      display:flex; align-items:center; justify-content:center;
      background-color:#7BD3CB;
      border-radius: 14px;
      margin-top:8px;
      padding: clamp(20px, 5vw, 28px);
      text-decoration:none; color:inherit;
      box-shadow: var(--shadow);
      font-weight:800; letter-spacing:.3px;
      font-size: clamp(16px, 3.8vw, 22px);    
      transition: transform .08s ease, box-shadow .2s ease, background .2s ease;
    }
    a.tile:hover{ box-shadow:0 12px 28px rgba(0,0,0,.12); background:#cfeeed }
    a.tile:active{ transform: scale(.985) }
    a.tile *{ pointer-events:none }

        /* ===== Empilhadeiras (2 colunas com pílulas) ===== */
    .emp-grid{
      display:grid;
      grid-template-columns: 1fr 1fr;  /* duas colunas */
      gap:12px 14px;
      align-items:start;
    }
    @media (max-width:520px){
      .emp-grid{ grid-template-columns: 1fr }  /* empilha no mobile */
    }

    .check-pill{
      display:flex; align-items:center; gap:10px;
      padding:12px 14px;
      background:#f9fbfb;
      border:1px solid #cfd8dc;
      border-radius:12px;
      min-height:46px;
      box-shadow: inset 0 0 0 0 rgba(61,183,172,.0);
      transition: box-shadow .2s ease, border-color .2s ease, background .2s ease;
    }
    .check-pill input[type="checkbox"]{
      width:18px; height:18px; accent-color:#0b4c59;  /* cor do check nos browsers que suportam */
    }
    .check-pill span{
      letter-spacing:.3px; color:#0b1f1e;
    }

    /* realce quando marcado (com fallback) */
    .check-pill input:checked + span{ color:#0b4c59; }
    .check-pill:has(input:checked){
      background:#fff;
      border-color:#3db7ac;
      box-shadow:0 0 0 3px rgba(61,183,172,.22);
    }
      
    @media (max-width:420px){.app{padding:12px}.radio-group{grid-template-columns:1fr}}
  </style>
</head>
<!-- ... <head> e CSS permanecem como você enviou, mas troque "período/períodos" por "periodo/periodos" ... -->

<body>
  <main class="app">
    <header class="card-header">
      <h1 class="title">ATUALIZAÇÃO EMPILHADEIRAS</h1>
      <p class="subtitle">DISPONIBILIDADE MECÂNICA</p>
    </header>

    <section class="card" aria-label="Formulário">
      <form id="form-os" action="#" method="post">
        <!-- DATA -->
        <h2 class="section-title">DATA</h2>
        <div class="field">
          <input id="dt-os" class="control" type="datetime-local" required placeholder="dd/mm/aaaa --:--"/>
        </div>

        <!-- PERÍODO -->
        <h2 class="section-title">PERÍODO</h2>
        <div class="field">
          <input id="periodo" name="periodo" class="control" list="periodos" required placeholder="Digite ou escolha" />
          <datalist id="periodos">
            <option value="00-01h"><option value="01-02h"><option value="02-03h"><option value="03-04h">
            <option value="04-05h"><option value="05-06h"><option value="06-07h"><option value="07-08h">
            <option value="08-09h"><option value="09-10h"><option value="10-11h"><option value="11-12h"><option value="12-13h">
            <option value="13-14h"><option value="14-15h"><option value="15-16h"><option value="16-17h"><option value="17-18h">
            <option value="18-19h"><option value="19-20h"><option value="20-21h"><option value="21-22h"><option value="22-23h">
            <option value="23-00h">
          </datalist>
        </div>

        <!-- DISPONÍVEIS -->
        <h2 class="section-title">EMPILHADEIRAS DISPONÍVEIS</h2>
        <div class="field">
          <div class="emp-grid" role="group" aria-labelledby="emp-disp">
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0021"><span>EMP0021</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0039"><span>EMP0039</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0046"><span>EMP0046</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0053"><span>EMP0053</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0078"><span>EMP0078</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0091"><span>EMP0091</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0092"><span>EMP0092</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0093"><span>EMP0093</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0095"><span>EMP0095</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0096"><span>EMP0096</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0097"><span>EMP0097</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0098"><span>EMP0098</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0099"><span>EMP0099</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0111"><span>EMP0111</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0112"><span>EMP0112</span></label>
            <label class="check-pill"><input type="checkbox" name="empDisp" value="EMP0188"><span>EMP0188</span></label>
          </div>
        </div>

        <!-- MANUTENÇÃO -->
        <h2 class="section-title">EMPILHADEIRAS EM MANUTENÇÃO</h2>
        <div class="field">
          <div class="emp-grid" role="group" aria-labelledby="emp-man">
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0021"><span>EMP0021</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0039"><span>EMP0039</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0046"><span>EMP0046</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0053"><span>EMP0053</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0078"><span>EMP0078</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0091"><span>EMP0091</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0092"><span>EMP0092</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0093"><span>EMP0093</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0095"><span>EMP0095</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0096"><span>EMP0096</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0097"><span>EMP0097</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0098"><span>EMP0098</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0099"><span>EMP0099</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0111"><span>EMP0111</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0112"><span>EMP0112</span></label>
            <label class="check-pill"><input type="checkbox" name="empMan" value="EMP0188"><span>EMP0188</span></label>
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="btnRef" type="submit">Registrar</button>
        </div>
      </form>

      <a class="tile" href="./index.html">⬅️ VOLTAR AO MENU</a>
      <a class="tile" href="#">🚪 SAIR</a>
    </section>
  </main>

  <script>
    const API_URL = "https://script.google.com/macros/s/AKfycbxe-_Yhj17NX0ze5GWo2v_W7llQD88gWIDKofhVNUrS8ShK82Hhs3nXHOwRr6nPGbknOg/exec";

    const form = document.getElementById('form-os');
    const btn  = document.getElementById('btnRef');

    function limparCampos(){
      form.reset();
      document.getElementById('dt-os').value = '';
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      // coleta checkboxes → string "EMP0039, EMP0046"
      const empDisp = Array.from(document.querySelectorAll('input[name="empDisp"]:checked'))
        .map(cb => cb.value).join(', ');
      const empMan  = Array.from(document.querySelectorAll('input[name="empMan"]:checked'))
        .map(cb => cb.value).join(', ');

      const dados = {
        data: document.getElementById('dt-os').value,
        periodo: document.getElementById('periodo').value,
        empilhadeiras_disponiveis: empDisp,
        empilhadeiras_em_manutencao: empMan
      };

      btn.disabled = true;
      btn.textContent = 'Enviando...';

      try {
        const body = 'dados=' + encodeURIComponent(JSON.stringify({
          action: 'salvarDMLPL',
          dados
        }));

        const resp = await fetch(API_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body
        });

        const json = await resp.json();
        if (json.sucesso){
          alert('✅ Registro salvo com sucesso!');
          limparCampos();
        } else {
          alert('❌ Falha ao salvar: ' + (json.mensagem || 'erro desconhecido'));
        }
      } catch (err){
        console.error(err);
        alert('❌ Erro ao conectar ao servidor.');
      } finally {
        btn.disabled = false;
        btn.textContent = 'Registrar';
      }
    });
  </script>
</body>
</html>

   
